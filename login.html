<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Service Booking | Secure Login</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
*{box-sizing:border-box}
body{
  margin:0;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  font-family:Inter,Segoe UI,Arial,sans-serif;
  background:
    radial-gradient(circle at top left,#1d4ed8,transparent 40%),
    radial-gradient(circle at bottom right,#0f766e,transparent 40%),
    #020617;
  color:#e5e7eb;
}

.card{
  width:380px;
  padding:32px 30px;
  border-radius:16px;
  background:rgba(255,255,255,0.08);
  backdrop-filter:blur(18px);
  border:1px solid rgba(255,255,255,0.15);
  box-shadow:0 25px 60px rgba(0,0,0,.45);
}

.brand{
  text-align:center;
  margin-bottom:22px;
}
.brand h1{
  font-size:22px;
  margin:0;
  font-weight:700;
  letter-spacing:.5px;
}
.brand p{
  margin-top:6px;
  font-size:13px;
  color:#9ca3af;
}

input,select{
  width:100%;
  padding:12px 14px;
  margin-bottom:14px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,0.2);
  background:rgba(2,6,23,.6);
  color:#e5e7eb;
  outline:none;
  font-size:14px;
}
input::placeholder{color:#94a3b8}
input:focus,select:focus{
  border-color:#38bdf8;
}

button{
  width:100%;
  padding:12px;
  border:none;
  border-radius:10px;
  font-size:15px;
  font-weight:600;
  cursor:pointer;
  background:linear-gradient(135deg,#38bdf8,#2563eb);
  color:#020617;
  transition:.25s;
}
button:hover{
  transform:translateY(-1px);
  box-shadow:0 12px 30px rgba(56,189,248,.45);
}

.switch{
  text-align:center;
  margin-top:14px;
  font-size:13px;
  color:#9ca3af;
}
.switch a{
  color:#38bdf8;
  font-weight:600;
  cursor:pointer;
}

#msg{
  text-align:center;
  font-size:13px;
  margin-top:12px;
}

.hidden{display:none}
</style>
</head>

<body>

<div class="card">

<div class="brand">
  <h1>Service Booking</h1>
  <p>Secure access portal</p>
</div>

<!-- LOGIN -->
<div id="loginBox">
  <input type="email" id="loginEmail" placeholder="Email address">
  <input type="password" id="loginPassword" placeholder="Password">
  <button onclick="login()">Sign In</button>
  <div class="switch">No account? <a onclick="showRegister()">Create one</a></div>
</div>

<!-- REGISTER -->
<div id="registerBox" class="hidden">
  <input type="text" id="name" placeholder="Full name">
  <input type="email" id="regEmail" placeholder="Email address">
  <input type="password" id="regPassword" placeholder="Password">

  <select id="role">
    <option value="client">Client</option>
    <option value="technician">Technician</option>
  </select>

  <button onclick="register()">Create Account</button>
  <div class="switch">Already registered? <a onclick="showLogin()">Sign in</a></div>
</div>

<p id="msg"></p>

</div>

<script>
firebase.initializeApp({
  apiKey: "AIzaSyAGjRba9QmovE8MSlvJTPSkKp7OsdbiqBw",
  authDomain: "service-booking-app-56dea.firebaseapp.com",
  projectId: "service-booking-app-56dea"
});

const auth=firebase.auth();
const db=firebase.firestore();

function showRegister(){
  loginBox.classList.add("hidden");
  registerBox.classList.remove("hidden");
  msg.innerText="";
}
function showLogin(){
  registerBox.classList.add("hidden");
  loginBox.classList.remove("hidden");
  msg.innerText="";
}

function register(){
  auth.createUserWithEmailAndPassword(
    regEmail.value,
    regPassword.value
  )
  .then(cred=>{
    return db.collection("users").doc(cred.user.uid).set({
      name:name.value,
      email:regEmail.value,
      role:role.value,
      createdAt:firebase.firestore.FieldValue.serverTimestamp()
    });
  })
  .then(()=>{
    msg.style.color="#22c55e";
    msg.innerText="Account created successfully";
    showLogin();
  })
  .catch(e=>{
    msg.style.color="#ef4444";
    msg.innerText=e.message;
  });
}

function login(){
  auth.signInWithEmailAndPassword(
    loginEmail.value,
    loginPassword.value
  )
  .then(cred=>{
    return db.collection("users").doc(cred.user.uid).get();
  })
  .then(doc=>{
      if(r==="admin")
      location.href="admin-panel/dashboard.html";
    else if(r==="technician")
      location.href="users/technician-dashboard.html";
    else
      location.href="users/client-dashboard.html";

  })
  .catch(e=>{
    msg.style.color="#ef4444";
    msg.innerText=e.message;
  });
}
</script>

</body>
</html>
